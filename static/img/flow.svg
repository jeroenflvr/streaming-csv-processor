<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="ACTIVITY" height="594px" preserveAspectRatio="none" style="width:585px;height:594px;background:#FFFFFF;" version="1.1" viewBox="0 0 585 594" width="585px" zoomAndPan="magnify"><defs/><g><ellipse cx="292.8047" cy="20" fill="#222222" rx="10" ry="10" style="stroke:#222222;stroke-width:1;"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="238.332" x="173.6387" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="218.332" x="183.6387" y="71.1387">Receive instruction from Kafka topic</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="135.1016" x="225.2539" y="103.9688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="115.1016" x="235.2539" y="125.1074">Extract S3 CSV link</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="129.7813" x="227.9141" y="157.9375"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="109.7813" x="237.9141" y="179.0762">Read CSV from S3</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="250.3262" x="167.6416" y="211.9063"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="230.3262" x="177.6416" y="233.0449">Cleanup CSV (remove trailing column)</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="130.918" x="227.3457" y="265.875"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="110.918" x="237.3457" y="287.0137">Transform to JSON</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="171.9219" x="206.8438" y="319.8438"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="151.9219" x="216.8438" y="340.9824">Add timestamp, filename</text><line style="stroke:#181818;stroke-width:1.5;" x1="101.9092" x2="511.1631" y1="373.8125" y2="373.8125"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="181.8184" x="11" y="393.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="161.8184" x="21" y="414.9512">Write to KStream (append)</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="198.8984" x="220.8184" y="393.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="178.8984" x="230.8184" y="414.9512">Write to KTable (upsert/state)</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="126.8926" x="447.7168" y="393.8125"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="106.8926" x="457.7168" y="414.9512">Call API (planned)</text><line style="stroke:#181818;stroke-width:1.5;" x1="101.9092" x2="511.1631" y1="447.7813" y2="447.7813"/><line style="stroke:#181818;stroke-width:1.5;" x1="162.0293" x2="378.9785" y1="467.7813" y2="467.7813"/><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="144.3477" x="89.8555" y="487.7813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="124.3477" x="99.8555" y="508.9199">Sink to DB (planned)</text><rect fill="#F1F1F1" height="33.9688" rx="12.5" ry="12.5" style="stroke:#181818;stroke-width:0.5;" width="233.5508" x="262.2031" y="487.7813"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="213.5508" x="272.2031" y="508.9199">Sink to Delta Table on S3 (planned)</text><line style="stroke:#181818;stroke-width:1.5;" x1="162.0293" x2="378.9785" y1="541.75" y2="541.75"/><ellipse cx="292.8047" cy="572.75" fill="none" rx="11" ry="11" style="stroke:#222222;stroke-width:1;"/><ellipse cx="292.8047" cy="572.75" fill="#222222" rx="6" ry="6" style="stroke:#222222;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.8047" x2="292.8047" y1="30" y2="50"/><polygon fill="#181818" points="288.8047,40,292.8047,50,296.8047,40,292.8047,44" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.8047" x2="292.8047" y1="83.9688" y2="103.9688"/><polygon fill="#181818" points="288.8047,93.9688,292.8047,103.9688,296.8047,93.9688,292.8047,97.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.8047" x2="292.8047" y1="137.9375" y2="157.9375"/><polygon fill="#181818" points="288.8047,147.9375,292.8047,157.9375,296.8047,147.9375,292.8047,151.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.8047" x2="292.8047" y1="191.9063" y2="211.9063"/><polygon fill="#181818" points="288.8047,201.9063,292.8047,211.9063,296.8047,201.9063,292.8047,205.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.8047" x2="292.8047" y1="245.875" y2="265.875"/><polygon fill="#181818" points="288.8047,255.875,292.8047,265.875,296.8047,255.875,292.8047,259.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.8047" x2="292.8047" y1="299.8438" y2="319.8438"/><polygon fill="#181818" points="288.8047,309.8438,292.8047,319.8438,296.8047,309.8438,292.8047,313.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="101.9092" x2="101.9092" y1="375.3125" y2="393.8125"/><polygon fill="#181818" points="97.9092,383.8125,101.9092,393.8125,105.9092,383.8125,101.9092,387.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="320.2676" x2="320.2676" y1="375.3125" y2="393.8125"/><polygon fill="#181818" points="316.2676,383.8125,320.2676,393.8125,324.2676,383.8125,320.2676,387.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="511.1631" x2="511.1631" y1="375.3125" y2="393.8125"/><polygon fill="#181818" points="507.1631,383.8125,511.1631,393.8125,515.1631,383.8125,511.1631,387.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="101.9092" x2="101.9092" y1="427.7813" y2="447.7813"/><polygon fill="#181818" points="97.9092,437.7813,101.9092,447.7813,105.9092,437.7813,101.9092,441.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="320.2676" x2="320.2676" y1="427.7813" y2="447.7813"/><polygon fill="#181818" points="316.2676,437.7813,320.2676,447.7813,324.2676,437.7813,320.2676,441.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="511.1631" x2="511.1631" y1="427.7813" y2="447.7813"/><polygon fill="#181818" points="507.1631,437.7813,511.1631,447.7813,515.1631,437.7813,511.1631,441.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.8047" x2="292.8047" y1="353.8125" y2="373.8125"/><polygon fill="#181818" points="288.8047,363.8125,292.8047,373.8125,296.8047,363.8125,292.8047,367.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="162.0293" x2="162.0293" y1="469.2813" y2="487.7813"/><polygon fill="#181818" points="158.0293,477.7813,162.0293,487.7813,166.0293,477.7813,162.0293,481.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="378.9785" x2="378.9785" y1="469.2813" y2="487.7813"/><polygon fill="#181818" points="374.9785,477.7813,378.9785,487.7813,382.9785,477.7813,378.9785,481.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="162.0293" x2="162.0293" y1="521.75" y2="541.75"/><polygon fill="#181818" points="158.0293,531.75,162.0293,541.75,166.0293,531.75,162.0293,535.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="378.9785" x2="378.9785" y1="521.75" y2="541.75"/><polygon fill="#181818" points="374.9785,531.75,378.9785,541.75,382.9785,531.75,378.9785,535.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.8047" x2="292.8047" y1="449.2813" y2="467.7813"/><polygon fill="#181818" points="288.8047,457.7813,292.8047,467.7813,296.8047,457.7813,292.8047,461.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="292.8047" x2="292.8047" y1="543.25" y2="561.75"/><polygon fill="#181818" points="288.8047,551.75,292.8047,561.75,296.8047,551.75,292.8047,555.75" style="stroke:#181818;stroke-width:1;"/><!--SRC=[RP11JyCm38Nl-HK-5Wc9msxjQHGER18WCi7PjEvaBN6Yn4NyVDnEGXCijrZlUyz-LR6eS-qR3SHV12nLopme9u6ff0Xxd4u8cZ8FdMiVlxNWeE0tqFjt22odRe5nNFyhuJSswWEXp7cTDeLYCcz3sOWZ32dCKMvCTYWeTKebMWBi_CkppRRZ2CgHgcBCjp1n8C58dNCr1rO7zjgFmaeBjFTQ22Cqc3F9QAQh2l28B7-r1_mC1CsSAnMzim2bQq2F8S3szGcQ75245bVpFiTVRk7j_iNuuVvI-i_lLqP14SvBMBzMulK0Q_i7]--></g></svg>